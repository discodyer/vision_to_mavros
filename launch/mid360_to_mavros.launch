<launch>

    <!-- This node will launch frame conversion from vision pose (tf) to mavros pose -->
    <arg name="target_frame_id"   default="/camera_odom_frame" />
    <param name="target_frame_id"   value="$(arg target_frame_id)" />

    <arg name="source_frame_id"   default="/camera_link" />
    <param name="source_frame_id"   value="$(arg source_frame_id)" />

    <param name="output_rate"       value="10" />

    <!-- Two steps alignment: 
    1) r,p,y: align current camera frame with default camera frame (x forward, y left, z up)
    2) gamma: align default camera frame's x axis with world y axis
    Frontfacing:
        Forward, USB port to the right (default): r = 0,          p = 0,          y = 0,  gamma = -1.5707963 
        Forward, USB port to the left           : r = 3.1415926,  p = 0,          y = 0,  gamma = -1.5707963 
    Downfacing: you need to tilt the vehicle's nose up a little (not flat) when launch the T265 realsense-ros node, otherwise the initial yaw will be randomized, read here: https://github.com/IntelRealSense/librealsense/issues/4080
    Tilt the vehicle to any other sides and the yaw might not be as stable.
        Downfacing, USB port to the right :       r = 0,          p = -1.5707963, y = 0,  gamma = -1.5707963
        Downfacing, USB port to the left  :       r = 3.1415926,  p = -1.5707963, y = 0,  gamma = -1.5707963
        Downfacing, USB port to the back  :       r = -1.5707963, p = -1.5707963, y = 0,  gamma = -1.5707963          
        Downfacing, USB port to the front :       r = 1.5707963,  p = -1.5707963, y = 0,  gamma = -1.5707963
    -->
    <!-- <param name="roll_cam"          value="3.1415926" />
    <param name="pitch_cam"         value="0" />
    <param name="yaw_cam"           value="0" />
    <param name="gamma_world"       value="-1.5707963" /> -->

    <!-- 添加旋转参数 -->
    <arg name="roll_lidar" default="0.0" />
    <param name="roll_lidar" value="$(arg roll_lidar)" />

    <arg name="pitch_lidar" default="0.0" />
    <param name="pitch_lidar" value="$(arg pitch_lidar)" />

    <arg name="yaw_lidar" default="0.0" />
    <param name="yaw_lidar" value="$(arg yaw_lidar)" />

    <!-- 添加平移参数 -->
    <arg name="x_lidar" default="0.0" />
    <param name="x_lidar" value="$(arg x_lidar)" />

    <arg name="y_lidar" default="0.0" />
    <param name="y_lidar" value="$(arg y_lidar)" />

    <arg name="z_lidar" default="-0.1" />
    <param name="z_lidar" value="$(arg z_lidar)" />


    <node pkg="vision_to_mavros" type="mid360_to_mavros_node" name="mid360_to_mavros" output="screen" >
        <remap from="mid360_pose" to="/mavros/vision_pose/pose" />
    </node>
</launch>
